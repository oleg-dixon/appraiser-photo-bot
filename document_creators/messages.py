"""
–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
"""

from typing import Dict, Optional
from datetime import datetime
from .utils import get_size_option_name, calculate_pages_info


class MessageGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    
    # ===== –ë–∞–∑–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è =====
    
    @staticmethod
    def get_session_expired_error() -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∏—Å—Ç–µ–∫—à–µ–π —Å–µ—Å—Å–∏–∏"""
        return "‚ùå –°–µ—Å—Å–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ."
    
    @staticmethod
    def get_start_prompt() -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É"""
        return "–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏—Ç–µ 'üü¢ –ù–∞—á–∞—Ç—å'"
    
    @staticmethod
    def get_initial_bot_message() -> str:
        """–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ"""
        return (
            "üñºÔ∏è *–ú–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π –§–æ—Ç–æ-–ë–æ—Ç*\n\n"
            "–Ø —Å–æ–∑–¥–∞–º Word –¥–æ–∫—É–º–µ–Ω—Ç –∏–∑ –≤–∞—à–∏—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å –Ω–µ–≤–∏–¥–∏–º—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏.\n\n"
            "üìå *–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:*\n"
            "‚úÖ *–ú–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ—Å—Ç—å* - –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ñ–æ—Ç–æ\n"
            "‚úÖ *–ê–≤—Ç–æ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ* - —Ñ–æ—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã\n"
            "‚úÖ *–ì–∏–±–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã* - –∫–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞\n\n"
            "üìù –í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã (–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ '–ë–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞' –µ—Å–ª–∏ –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞):"
        )
    
    @staticmethod
    def get_title_saved_message(title: str) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞"""
        return (
            f"‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω: *{title}*\n\n"
            "–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ *–°–¢–†–û–ö* –≤ —Ç–∞–±–ª–∏—Ü–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3):\n\n"
            "*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –≠—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
        )
    
    @staticmethod
    def get_no_title_message() -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞"""
        return (
            "‚úÖ –•–æ—Ä–æ—à–æ, –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞.\n\n"
            "–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ *–°–¢–†–û–ö* –≤ —Ç–∞–±–ª–∏—Ü–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3):\n\n"
            "*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –≠—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
        )
    
    @staticmethod
    def get_rows_saved_message(rows: int) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫"""
        return (
            f"‚úÖ –°—Ç—Ä–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: *{rows}*\n\n"
            "–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ *–°–¢–û–õ–ë–¶–û–í* –≤ —Ç–∞–±–ª–∏—Ü–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 4):\n\n"
            "*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –≠—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
        )
    
    @staticmethod
    def get_cols_saved_message(cols: int, rows: int, photos_per_page: int) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç–æ–ª–±—Ü–æ–≤"""
        return (
            f"‚úÖ –°—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: *{cols}*\n\n"
            f"–¢–µ–ø–µ—Ä—å –≤–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ *–°–¢–û–õ–ë–¶–û–í* –≤ —Ç–∞–±–ª–∏—Ü–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 4):\n\n"
            f"*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –≠—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
        )
    
    # ===== –°–æ–æ–±—â–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ =====
    
    @staticmethod
    def get_size_selection_message(rows: int, cols: int) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–æ—Ç–æ"""
        photos_per_page = rows * cols
        return (
            f"‚úÖ –°—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: *{cols}*\n"
            f"üìä –†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: *{rows}√ó{cols}*\n"
            f"üìç –§–æ—Ç–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: *{photos_per_page}*\n\n"
            "üìè –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ —Ç–∞–±–ª–∏—Ü–µ:"
        )
    
    @staticmethod
    def get_upload_instructions(rows: int, cols: int, size_text: str) -> str:
        """–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ"""
        photos_per_page = rows * cols
        return (
            f"‚úÖ –†–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ: *{size_text}*\n\n"
            f"üìç –§–æ—Ç–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: *{photos_per_page}*\n\n"
            f"üìå *–ö–∞–∫ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ:*\n"
            f"1. –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ñ–æ—Ç–æ –ø–æ –æ–¥–Ω–æ–º—É –∏–ª–∏ –ø–∞—á–∫–∞–º–∏\n"
            f"2. –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ —Å—Ç–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü, —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ\n"
            f"3. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ - —Ç–∞–±–ª–∏—Ü–∞ {rows}√ó{cols}\n"
            f"4. –ö–æ–≥–¥–∞ –≤—Å–µ —Ñ–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –Ω–∞–∂–º–∏—Ç–µ '‚úÖ –ì–æ—Ç–æ–≤–æ'\n\n"
            f"*–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ —Ñ–æ—Ç–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ '‚úÖ –ì–æ—Ç–æ–≤–æ'*"
        )
    
    @staticmethod
    def generate_upload_progress(current: int, rows: int, cols: int) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ.
        
        Args:
            current: —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ
            rows: —Å—Ç—Ä–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
            cols: —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
        """
        photos_per_page = rows * cols
        
        # –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
        if photos_per_page > 0:
            current_page = (current - 1) // photos_per_page + 1 if current > 0 else 1
            
            # –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            progress_on_page = current % photos_per_page
            if progress_on_page == 0 and current > 0:
                progress_on_page = photos_per_page
                
            progress = int(progress_on_page / photos_per_page * 20)
            progress_bar = "üü©" * progress + "‚¨ú" * (20 - progress)
        else:
            current_page = 1
            progress_bar = ""
            progress_on_page = current
            photos_per_page = current
        
        page_info = calculate_pages_info(current, rows, cols)
        
        return (
            f"üì• *–ü–æ–ª—É—á–µ–Ω–æ —Ñ–æ—Ç–æ: {current}*\n"
            f"üìÑ *–°—Ç—Ä–∞–Ω–∏—Ü–∞: {current_page}/{page_info['total_pages']}*\n"
            f"üìç *–ù–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {progress_on_page}/{photos_per_page}*\n"
            f"{progress_bar}\n\n"
            f"üìã *–í—Å–µ–≥–æ –±—É–¥–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü: {page_info['total_pages']}*\n"
            f"üîÑ *–û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –µ—â—ë —Ñ–æ—Ç–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ '‚úÖ –ì–æ—Ç–æ–≤–æ'*"
        )
    
    # ===== –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è =====
    
    @staticmethod
    def generate_document_stats(photos_count: int, rows: int, cols: int, page_info: Dict) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        stats = []
        
        if photos_count == 1:
            stats.append(f"üì∑ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π: 1")
        else:
            stats.append(f"üì∑ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π: {photos_count}")
        
        stats.append(f"üìä –¢–∞–±–ª–∏—Ü–∞: {rows}√ó{cols}")
        stats.append(f"üìç –§–æ—Ç–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {page_info['photos_per_page']}")
        
        if page_info['total_pages'] == 1:
            stats.append(f"üìÑ –°—Ç—Ä–∞–Ω–∏—Ü: 1")
        else:
            stats.append(f"üìÑ –°—Ç—Ä–∞–Ω–∏—Ü: {page_info['total_pages']}")
            if page_info['photos_on_last_page'] != page_info['photos_per_page']:
                stats.append(f"üìå –ù–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {page_info['photos_on_last_page']} —Ñ–æ—Ç–æ")
        
        return "\n".join(stats)
    
    @staticmethod
    def get_confirmation_message(title: Optional[str], photos_count: int, rows: int, cols: int,
                                size_option: str, page_info: Dict) -> str:
        """–°–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        size_text = get_size_option_name(size_option)
        stats = MessageGenerator.generate_document_stats(photos_count, rows, cols, page_info)
        
        return (
            f"‚úÖ *–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!*\n\n"
            f"üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:*\n"
            f"{stats}\n\n"
            f"üìù *–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:*\n"
            f"‚Ä¢ –ó–∞–≥–æ–ª–æ–≤–æ–∫: {title or '–Ω–µ—Ç'}\n"
            f"‚Ä¢ –†–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ: {size_text}\n\n"
            f"*–°–æ–∑–¥–∞–µ–º –º–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç?*"
        )
    
    # ===== –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º =====
    
    @staticmethod
    def get_creating_document_message_with_progress(photos_count: int, rows: int, cols: int, 
                                                   page_info: Dict, progress: int = 10) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º"""
        return (
            f"üõ†Ô∏è *–°–æ–∑–¥–∞—é –¥–æ–∫—É–º–µ–Ω—Ç...* ({progress}%)\n\n"
            f"üì∑ –§–æ—Ç–æ: {photos_count}\n"
            f"üìä –¢–∞–±–ª–∏—Ü–∞: {rows}√ó{cols}\n"
            f"üìÑ –°—Ç—Ä–∞–Ω–∏—Ü: {page_info['total_pages']}\n"
            f"‚è±Ô∏è –≠—Ç–æ –∑–∞–π–º–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è..."
        )
    
    @staticmethod
    def get_sending_document_message_with_progress(doc_size_mb: float, progress: int = 50) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º"""
        return (
            f"üì§ *–û—Ç–ø—Ä–∞–≤–ª—è—é –¥–æ–∫—É–º–µ–Ω—Ç...* ({progress}%)\n\n"
            f"üì¶ –†–∞–∑–º–µ—Ä: {doc_size_mb:.1f} MB\n"
            f"‚è±Ô∏è –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è..."
        )
    
    @staticmethod
    def get_file_sent_message(progress: int = 80) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ —Ñ–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º"""
        return f"üìé *–§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω* ({progress}%)"
    
    @staticmethod
    def get_document_success_message_with_progress(photos_count: int, rows: int, cols: int, 
                                                  page_info: Dict, doc_size_mb: float, 
                                                  progress: int = 100) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º"""
        return (
            f"‚úÖ *–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!* ({progress}%)\n\n"
            f"üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:*\n"
            f"‚Ä¢ –§–æ—Ç–æ: {photos_count}\n"
            f"‚Ä¢ –¢–∞–±–ª–∏—Ü–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {rows}√ó{cols}\n"
            f"‚Ä¢ –°—Ç—Ä–∞–Ω–∏—Ü: {page_info['total_pages']}\n"
            f"‚Ä¢ –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {doc_size_mb:.1f} MB\n\n"
            "üì¶ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –ø–∞–º—è—Ç–∏ –±–æ—Ç–∞.\n"
            "üîÑ –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ - 'üü¢ –ù–∞—á–∞—Ç—å'"
        )
    
    # ===== –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö =====
    
    @staticmethod
    def get_too_many_photos_error(photos_count: int, max_photos: int = 15) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ñ–æ—Ç–æ"""
        return (
            f"‚ö†Ô∏è *–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ñ–æ—Ç–æ ({photos_count})*\n\n"
            f"–î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ –±–æ–ª–µ–µ {max_photos} —Ñ–æ—Ç–æ –∑–∞ —Ä–∞–∑.\n\n"
            f"üìã *–ß—Ç–æ –¥–µ–ª–∞—Ç—å:*\n"
            f"1. –£–¥–∞–ª–∏—Ç–µ —á–∞—Å—Ç—å —Ñ–æ—Ç–æ (–æ—Å—Ç–∞–≤—å—Ç–µ –Ω–µ –±–æ–ª–µ–µ {max_photos})\n"
            f"2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /done —Å–Ω–æ–≤–∞\n"
            f"3. –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ 'üü¢ –ù–∞—á–∞—Ç—å' –¥–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–Ω–æ–≤–æ"
        )
    
    @staticmethod
    def get_document_too_big_error(doc_size_mb: float) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: –¥–æ–∫—É–º–µ–Ω—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π"""
        return (
            f"‚ö†Ô∏è *–î–æ–∫—É–º–µ–Ω—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π ({doc_size_mb:.1f} MB)*\n\n"
            f"Telegram –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –±–æ–ª—å—à–µ 50MB.\n\n"
            f"üìã *–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:*\n"
            f"‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ 10 —Ñ–æ—Ç–æ –∑–∞ —Ä–∞–∑\n"
            f"‚Ä¢ –í—ã–±–∏—Ä–∞–π—Ç–µ '–ú–∞–ª–µ–Ω—å–∫–∏–π' —Ä–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ\n"
            f"‚Ä¢ –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ñ–æ—Ç–æ –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è\n"
            f"‚Ä¢ –†–∞–∑–¥–µ–ª–∏—Ç–µ —Ñ–æ—Ç–æ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤\n\n"
            f"üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ —Å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–æ—Ç–æ, –Ω–∞–∂–º–∏—Ç–µ: 'üü¢ –ù–∞—á–∞—Ç—å'"
        )
    
    @staticmethod
    def get_timeout_error(doc_size_mb: float) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–∞–π–º–∞—É—Ç–∞"""
        return (
            "‚è≥ *–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏*\n\n"
            f"–î–æ–∫—É–º–µ–Ω—Ç ({doc_size_mb:.1f} MB) —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏.\n\n"
            "üìã *–ß—Ç–æ –¥–µ–ª–∞—Ç—å:*\n"
            "1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç - —Ñ–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞–≤–ª–µ–Ω\n"
            "2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–æ—Ç–æ (–¥–æ 5-10)\n"
            "3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ç–æ –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞\n"
            "4. –í—ã–±–∏—Ä–∞–π—Ç–µ '–ú–∞–ª–µ–Ω—å–∫–∏–π' —Ä–∞–∑–º–µ—Ä –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö\n\n"
            "üîÑ –ù–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ: /start"
        )
    
    @staticmethod
    def get_file_too_big_error(doc_size_mb: float) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: —Ñ–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è Telegram"""
        return (
            "üì¶ *–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π*\n\n"
            f"–î–æ–∫—É–º–µ–Ω—Ç ({doc_size_mb:.1f} MB) –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç—ã Telegram.\n\n"
            "üìã *–õ–∏–º–∏—Ç—ã Telegram:*\n"
            "‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ~50MB\n"
            "‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: –¥–æ 20MB\n\n"
            "üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–æ—Ç–æ, –Ω–∞–∂–º–∏—Ç–µ: 'üü¢ –ù–∞—á–∞—Ç—å'"
        )
    
    @staticmethod
    def get_generic_api_error(error_msg: str) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±—â–µ–π –æ—à–∏–±–∫–µ Telegram API"""
        return (
            f"‚ùå *–û—à–∏–±–∫–∞ Telegram API:*\n\n"
            f"`{error_msg[:200]}...`\n\n"
            f"üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞, –Ω–∞–∂–º–∏—Ç–µ: 'üü¢ –ù–∞—á–∞—Ç—å'"
        )
    
    @staticmethod
    def get_creation_timeout_error() -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–∞–π–º–∞—É—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è"""
        return (
            "‚è≥ *–ü—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–Ω—è–ª —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏*\n\n"
            "–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å —Ç–∞–∫–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–æ—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n\n"
            "üìã *–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:*\n"
            "‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ 10 —Ñ–æ—Ç–æ –∑–∞ —Ä–∞–∑\n"
            "‚Ä¢ –í—ã–±–∏—Ä–∞–π—Ç–µ –º–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ\n"
            "‚Ä¢ –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ñ–æ—Ç–æ –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è\n\n"
            "üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞, –Ω–∞–∂–º–∏—Ç–µ: 'üü¢ –ù–∞—á–∞—Ç—å'"
        )
    
    @staticmethod
    def get_generic_creation_error(error_msg: str) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ–±—â–µ–π –æ—à–∏–±–∫–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        return (
            f"‚ùå *–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:*\n\n"
            f"`{error_msg[:200]}...`\n\n"
            f"üìã *–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:*\n"
            f"‚Ä¢ –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ñ–æ—Ç–æ\n"
            f"‚Ä¢ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏\n"
            f"‚Ä¢ –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º —Ñ–æ—Ç–æ\n\n"
            f"üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞, –Ω–∞–∂–º–∏—Ç–µ: 'üü¢ –ù–∞—á–∞—Ç—å'"
        )
    
    # ===== –£—Ç–∏–ª–∏—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã =====
    
    @staticmethod
    def create_caption(title: Optional[str], photos_count: int, rows: int, cols: int, 
                       size_option: str, page_info: Dict) -> str:
        """–°–æ–∑–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        size_text = get_size_option_name(size_option)
        
        caption = (
            f"‚úÖ *–ì–æ—Ç–æ–≤–æ!*\n\n"
            f"üìã –î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω\n"
            f"üì∑ –§–æ—Ç–æ: {photos_count}\n"
            f"üìä –¢–∞–±–ª–∏—Ü–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: {rows}√ó{cols}\n"
            f"üìÑ –°—Ç—Ä–∞–Ω–∏—Ü: {page_info['total_pages']}\n"
            f"üìè –†–∞–∑–º–µ—Ä —Ñ–æ—Ç–æ: {size_text}\n"
        )
        
        if title:
            caption += f"üìù –ó–∞–≥–æ–ª–æ–≤–æ–∫: {title}\n"
        else:
            caption += f"üìù –ó–∞–≥–æ–ª–æ–≤–æ–∫: –ë–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞\n"
        
        caption += f"\nüîÑ –î–ª—è –Ω–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ - 'üü¢ –ù–∞—á–∞—Ç—å'"
        
        return caption
    
    @staticmethod
    def get_document_caption(title: Optional[str], photos_count: int, rows: int, cols: int,
                            size_option: str, page_info: Dict) -> str:
        """–ö–æ—Ä–æ—Ç–∫–∞—è –ø–æ–¥–ø–∏—Å—å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞"""
        size_text = get_size_option_name(size_option)
        
        if title:
            caption = f"üìé {title} - {photos_count} —Ñ–æ—Ç–æ ({rows}√ó{cols})"
        else:
            caption = f"üìé {photos_count} —Ñ–æ—Ç–æ, —Ç–∞–±–ª–∏—Ü–∞ {rows}√ó{cols}"
        
        caption += f" | üìè {size_text} | üìÑ {page_info['total_pages']} —Å—Ç—Ä."
        return caption
    
    @staticmethod
    def generate_filename(title: Optional[str], photos_count: int, rows: int, cols: int) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞."""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        if title:
            # –û—á–∏—â–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –æ—Ç –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
            clean_title = ''.join(c for c in title if c.isalnum() or c in (' ', '-', '_')).strip()
            clean_title = clean_title.replace(' ', '_')
            return f"{clean_title}_{photos_count}photos_{rows}x{cols}_{timestamp}.docx"
        else:
            return f"photos_{photos_count}_{rows}x{cols}_{timestamp}.docx"
    
    @staticmethod
    def get_back_confirmation_message() -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞"""
        return (
            "‚ö†Ô∏è *–í–Ω–∏–º–∞–Ω–∏–µ!*\n\n"
            "–£ –≤–∞—Å –µ—Å—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏. –í–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –∏—Ö —É–¥–∞–ª–µ–Ω–∏—é.\n\n"
            "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥?"
        )
    
    @staticmethod
    def get_photos_cleared_message(photos_count: int) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—á–∏—Å—Ç–∫–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π"""
        return (
            f"‚úÖ –û—á–∏—â–µ–Ω–æ {photos_count} —Ñ–æ—Ç–æ.\n\n"
            f"–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ 'üü¢ –ù–∞—á–∞—Ç—å' –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞."
        )
    
    @staticmethod
    def get_no_photos_error() -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: –Ω–µ—Ç —Ñ–æ—Ç–æ"""
        return (
            "‚ùå –í—ã –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏.\n"
            "–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ 'üü¢ –ù–∞—á–∞—Ç—å' –¥–ª—è –Ω–∞—á–∞–ª–∞."
        )


# –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
message_generator = MessageGenerator()

# –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (–º–æ–∂–Ω–æ –±—É–¥–µ—Ç —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∂–µ)
def generate_document_stats(*args, **kwargs):
    return MessageGenerator.generate_document_stats(*args, **kwargs)

def get_photo_upload_progress(*args, **kwargs):
    return MessageGenerator.generate_upload_progress(*args, **kwargs)